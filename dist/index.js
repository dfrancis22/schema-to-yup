function t(t){return t&&"object"==typeof t&&"default"in t?t.default:t}var n=require("yup"),e=t(require("uniq")),r=t(require("dashify")),i=t(require("uppercamelcase"));function s(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,n,e){return n&&s(t.prototype,n),e&&s(t,e),t}function o(){return(o=Object.assign||function(t){for(var n=1;n<arguments.length;n++){var e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t}).apply(this,arguments)}function u(t,n){t.prototype=Object.create(n.prototype),t.prototype.constructor=t,t.__proto__=n}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function h(t,n){return(h=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function l(t,n,e){return(l=f()?Reflect.construct:function(t,n,e){var r=[null];r.push.apply(r,n);var i=new(Function.bind.apply(t,r));return e&&h(i,e.prototype),i}).apply(null,arguments)}function p(t){var n="function"==typeof Map?new Map:void 0;return(p=function(t){if(null===t||-1===Function.toString.call(t).indexOf("[native code]"))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,e)}function e(){return l(t,arguments,c(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),h(e,t)})(t)}function d(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}var y={getProps:function(t){return t&&t.properties},getType:function(t){return t&&t.type},getName:function(t){return t&&t.name||t.title},getConstraints:function(t){return t},isString:function(t){return t&&"string"===t.type},isArray:function(t){return t&&"array"===t.type},isInteger:function(t){return t&&"integer"===t.type||"int"===t.type},isBoolean:function(t){return t&&"boolean"===t.type},hasDateFormat:function(t){return t&&["date","date-time"].find(function(n){return n===t.format})},isDate:function(t){return t&&"string"===t.type&&y.hasDateFormat(t.format)},isNumber:function(t){return t&&("number"===t.type||y.isInteger(t))},isObject:function(t){return t&&"object"===t.type},isRequired:function(t){return t&&t.required}},m={getProps:function(t){return t.properties},getType:function(t){return t.type},getName:function(t){return t.name||t.title},getConstraints:function(t){return t},isString:function(t){return"string"===t.type&&!m.hasDateFormat(t)},isArray:function(t){return"array"===t.type},isBoolean:function(t){return"boolean"===t.type},isInteger:function(t){return"integer"===t.type},hasDateFormat:function(t){var n;return["date","date-time"].includes(null==t||null==(n=t.value)?void 0:n.format)},isDate:function(t){return"string"===t.type&&m.hasDateFormat(t)},isNumber:function(t){return"number"===t.type||m.isInteger(t)},isObject:function(t){return"object"===t.type},isRequired:function(t){return t.required}},v={"json-schema":y,"type-def":m},g=function(t){function n(n){return void 0===n&&(n={}),t.call(this,n)||this}u(n,t);var e=n.prototype;return e.isNothing=function(t){return null==t},e.isPresent=function(t){return!this.isNothing(t)},e.toNumber=function(t){return Number(t)},e.isNumberLike=function(t){return!isNaN(this.toNumber(t))},e.isObjectType=function(t){return t===Object(t)},e.isArrayType=function(t){return Array.isArray(t)},e.isNumberType=function(t){return!isNaN(t)},e.isStringType=function(t){return"string"==typeof t},e.isFunctionType=function(t){return"function"==typeof t},e.isDateType=function(t){return t instanceof Date},n}(function(){function t(t){void 0===t&&(t={}),this.config=t;var n=t.log,e=t.error;this.enable=t.enable||{},this.log="function"==typeof n?n:console.log,this.err="function"==typeof e?e:console.error}var n=t.prototype;return n.error=function(t,n){if(!1!==this.enable.error)throw this.err&&(n?this.err(t,n):this.err(t)),t},n.warn=function(t,n){this.enable.warn&&this.logInfo("WARNING: "+t,n)},n.logInfo=function(t,n){this.enable.log&&this.log&&(n?this.log(t,n):this.log(t))},t}()),b=function(t){function n(n){var e;return void 0===n&&(n={}),(e=t.call(this,n)||this).config=o({},v[n.schemaType||"json-schema"],n),e}return u(n,t),n}(g);function w(t){return t===Object(t)}var C=function(){function t(t,n){void 0===n&&(n={}),this.whenEntryObj=t;var e=n.properties,r=n.config,i=n.key,s=n.when,a=n.type;this.schema=n.schema,this.when=s,this.properties=e||{},this.key=i,this.type=a,this.config=r}var n=t.prototype;return n.validateAndConfigure=function(t){if(!w(t=t||this.whenEntryObj))return this.warn("invalid or missing when entry constraint object",t),!1;var n=Object.keys(t);return n.length<2?(this.warn("validateAndConfigure: when entry constraint must have at least 2 keys: "+n,t),!1):this.hasKey(n,"is")?!!this.hasKey(n,"then")||(this.warn("validateAndConfigure: when entry constraint missing 'then' or 'else' constraint: "+n,t),!1):(this.warn("validateAndConfigure: when entry constraint missing 'is' constraint: "+n,t),!1)},n.createYupSchemaEntry=function(t){return this.config.createYupSchemaEntry(t)},n.createValue=function(t,n){var e;return"string"==typeof t&&((e={})[t]=!0,t=e),w(t)||this.error("createValue: "+n+" must be a schema object"),o({key:this.key,type:this.type},t)},n.createEntryOpts=function(t,n){var e=this.createValue(t,n);return{schema:this.schema,properties:this.properties,key:this.key,type:this.type,value:e,config:this.config}},n.createEntry=function(t,n){var e=this.createEntryOpts(t,n);return this.createYupSchemaEntry(e)},n.hasKey=function(t,n){return t.find(function(t){return t===n})},n.hasAnyKey=function(t,n){return t.find(function(t){return n.includes(t)})},n.whenEntryFor=function(t,n,e){var r;if(e=e||n,"string"==typeof t&&((r={})[t]=!0,t=r),!w(t))throw"whenEntryFor: Invalid when object "+t;var i=o({},t[e]);return delete t[e],i?(t[n]=this.createEntry(i,n),t):t},n.calcEntryObj=function(){var t=o({},this.whenEntryObj);return"otherwise"in(t=this.whenEntryFor(t,"then"))&&(t=this.whenEntryFor(t,"otherwise")),"else"in t&&(t=this.whenEntryFor(t,"else")),t},n.warn=function(t,n){console.error("[WhenEntry] WARNING",t,n)},n.error=function(t,n){throw console.error("[WhenEntry] ERROR",t,n),t},a(t,[{key:"entryObj",get:function(){return this.validateAndConfigure()&&this.calcEntryObj()}}]),t}();function E(t){return t===Object(t)}var k=function(){function t(t){void 0===t&&(t={});var n=t.type,e=t.key,r=t.value,i=t.when,s=t.schema,a=t.properties,o=t.config;this.opts=t,this.when=i,this.key=e,this.type=n,this.value=r,this.schema=s,this.properties=a,this.config=o,this.validate()}var n=t.prototype;return n.validate=function(){"string"!=typeof this.type&&this.error("validate: invalid or mising type: "+this.type,this.opts),E(this.when)||this.error("validate: invalid or mising when: "+this.when,this.opts)},n.validateAndConfigure=function(t){if(!E(t=t||this.when))return this.warn("invalid or missing when constraint",t),!1;var n=Object.keys(t);return n.length<1?(this.warn("when constraint must have at least 1 key: "+n,t),!1):(this.whenKeys=n,!0)},n.createWhenEntry=function(t,n){return function(t,n){return void 0===n&&(n={}),new C(t,n)}(t,n)},n.accumulate=function(t,n){var e=this.when[n];if(!E(e))return this.warn("invalid when entry constraint object "+e+" for "+n),t;var r=this.createWhenEntry(e,{type:this.type,key:this.key,schema:this.schema,properties:this.properties,config:this.config}).entryObj;return r?t=Object.assign(t,r):t},n.warn=function(t,n){console.error("[WhenCondition] WARNING",t,n)},n.error=function(t,n){throw console.error("[WhenCondition] ERROR",t,n),t},a(t,[{key:"constraintObj",get:function(){return this.whenKeys?this.whenKeys.reduce(this.accumulate.bind(this),{}):{}}},{key:"keyVal",get:function(){var t=this.whenKeys||[];return 1===t.length?t[0]:t}},{key:"constraintValue",get:function(){return!!this.keyVal&&[this.keyVal,this.constraintObj]}},{key:"constraint",get:function(){return this.validateAndConfigure()&&this.constraintValue}}]),t}(),O=function(t){return new k(t)},N=function(t){function n(n,e){var r;return void 0===e&&(e={}),(r=t.call(this,e)||this).typeHandler=n,r.constraintsAdded={},r.delegators.map(function(t){r[t]=n[t]}),r}u(n,t);var e=n.prototype;return e.build=function(t,n){void 0===n&&(n={});var e=n.constraintName,r=n.constraintValue,i=n.method,s=n.yup,a=n.values,o=n.errName;if(s=s||this.base,this.isNothing(r=r||n.propValue||this.constraints[t]))return this.warn("no prop value"),!1;e=e||t;var u=this.aliasMap[i=i||e]||i;if(!s[u])return this.warn("Yup has no such API method: "+u),!1;for(var c,h=s[u].bind(s),f=this.valErrMessage(e),l=o&&this.valErrMessage(o),p={constraintName:e,yup:s,constraintFn:h,errFn:f||l},d=0,y=["multiValueConstraint","presentConstraintValue","nonPresentConstraintValue"];d<y.length&&!(c=this[y[d]](a,p));d++);return c?(this.base=c,c):(this.warn("buildConstraint: missing value or values options"),!1)},e.nonPresentConstraintValue=function(t,n){var e=n.constraintName,r=n.constraintFn,i=n.errFn;if(!this.isPresent(t))return this.onConstraintAdded({name:e}),r(i)},e.presentConstraintValue=function(t,n){var e=n.constraintName,r=n.constraintFn,i=n.errFn;if(this.isPresent(t))return this.onConstraintAdded({name:e,value:t}),this.isNoValueConstraint(e)?r(i):r(t,i)},e.multiValueConstraint=function(t,n){var e=n.constraintFn,r=n.constraintName,i=n.errFn;if(this.isPresent(t)){if(Array.isArray(t))return this.onConstraintAdded({name:r,value:t}),this.callConstraintFn(e,r,t,i);this.warn("buildConstraint: values option must be an array of arguments")}},e.callConstraintFn=function(t,n,e,r){return this.isMultiArgsCall(n)?t.apply(void 0,e.concat([r])):t(e,r)},e.isMultiArgsCall=function(t){return this.multiArgsValidatorMethods[t]},e.isNoValueConstraint=function(t){return this.noValueConstraints.includes(t)},e.addValueConstraint=function(t,n){var e=void 0===n?{}:n;return this.addConstraint(t,{constraintName:e.constraintName,value:!0,errName:e.errName})},e.addConstraint=function(t,n){var e=this.build(t,n);return!!e&&(this.typeHandler.base=e,e)},e.onConstraintAdded=function(t){return this.constraintsAdded[t.name]=t.value,this.typeHandler},e.valErrMessage=function(t){return this.errorMessageHandler.valErrMessage(t)},a(n,[{key:"delegators",get:function(){return["errMessages","base","key","constraints","errorMessageHandler"]}},{key:"multiArgsValidatorMethods",get:function(){return this.config.multiArgsValidatorMethods||{when:!0}}},{key:"noValueConstraints",get:function(){return["required","email","url","format"]}},{key:"constraintsMap",get:function(){return{simple:["required","notRequired","nullable"],value:["default","strict"]}}},{key:"aliasMap",get:function(){return{oneOf:"oneOf",enum:"oneOf",anyOf:"oneOf"}}}]),n}(g),M=function(t){function n(n,e){var r;return void 0===e&&(e={}),(r=t.call(this,e)||this).typeHandler=n,r.constraints=n.constraints,r.errMessages=n.errMessages,r.key=n.key,r.type=n.type,r}u(n,t);var e=n.prototype;return e.valErrMessage=function(t){var n=this.constraints,e=this.errMessageFor(t);return"function"==typeof e?e(n):e},e.errMessageFor=function(t){var n=this.errMessages,e=n[this.key];return e?e[t]:n["$"+t]},n}(g),T=function(t){function n(){return t.apply(this,arguments)||this}return u(n,t),n}(p(Error)),x=function(t){function r(e){var r;void 0===e&&(e={}),r=t.call(this,e.config)||this;var i=e.schema,s=e.key,a=e.value,o=e.config;return o=o||{},i=i||{},r.validateOnCreate(s,a,e),r.yup=n,r.key=s,r.schema=i,r.properties=i.properties||{},r.value=a,r.constraints=r.getConstraints(),r.format=a.format||r.constraints.format,r.config=o||{},r.type="mixed",r.mixedConfig=r.config.mixed||{},r.typeConfig=r.config[r.type]||{},r.base=n.mixed(),r.errMessages=o.errMessages||{},r.configureTypeConfig(),r.constraintsAdded={},r}u(r,t);var i=r.prototype;return i.configureTypeConfig=function(){this.typeConfig.enabled||this.typeConfig.extends||this.typeConfig.convert&&(this.typeConfig.extends=Object.keys(this.typeConfig.convert))},i.isRequired=function(t){return!0===(t=t||this.value).required},i.disabledMode=function(t){var n=this.mode[t];return!!this.disableFlags.find(function(t){return n===t})},i.enabledMode=function(t){var n=this.mode[t];return!!this.enableFlags.find(function(t){return n===t})},i.preProcessedConstraintValue=function(t){return this.shouldPreProcessValue?this.isRequired(t)?t:o({},t,{notRequired:!0}):t},i.initHelpers=function(){var t=this.config;this.errorMessageHandler=(this.config.createErrorMessageHandler||this.createErrorMessageHandler)(this,t),this.constraintBuilder=(this.config.createConstraintBuilder||this.createConstraintBuilder)(this,t),this.rebind("addConstraint","addValueConstraint")},i.createConstraintBuilder=function(t,n){return void 0===n&&(n={}),new N(t,n)},i.createErrorMessageHandler=function(t,n){return void 0===n&&(n={}),new M(t,n)},i.rebind=function(){var t=this;[].slice.call(arguments).map(function(n){var e=t[n];t[n]=t.isFunctionType(e)?e.bind(t):e})},i.validateOnCreate=function(t,n,e){t||this.error("create: missing key "+JSON.stringify(e)),n||this.error("create: missing value "+JSON.stringify(e))},i.convertEnabled=function(){var t=this;this.enabled.map(function(n){var e=t.convertFnFor(n);e&&e(t)})},i.convertFnFor=function(t){return this.customConvertFnFor(t)||this.builtInConvertFnFor(t)},i.customConvertFnFor=function(t){return(this.typeConfig.convert||{})[t]},i.builtInConvertFnFor=function(t){return this[t].bind(this)},i.getConstraints=function(){return this.config.getConstraints(this.value)},i.createSchemaEntry=function(){return this.convert().base},i.convert=function(){return this.initHelpers(),this.addMappedConstraints(),this.convertEnabled(),this},i.addValueConstraint=function(t,n){var e=this.constraintBuilder.addValueConstraint(t,n);return e&&(this.base=e.base),this},i.addConstraint=function(t,n){var e=this.constraintBuilder.addConstraint(t,n);return e&&(this.base=e),this},i.addMappedConstraints=function(){var t=Object.keys(this.constraintsMap),n=this.addMappedConstraint.bind(this);return t.map(n),this},i.addMappedConstraint=function(t){var n=this["value"===t?"addValueConstraint":"addConstraint"];this.constraintsMap[t].map(function(t){n(t)})},i.oneOf=function(){var t=this,n=this.constraints.enum||this.constraints.oneOf||this.constraints.anyOf;if(this.isNothing(n))return this;n=Array.isArray(n)?n:[n];var e=["oneOf","enum","anyOf"].find(function(n){return void 0!==t.constraints[n]});return this.addConstraint(e,{values:n})},i.notOneOf=function(){var t=this.constraints,n=t.not,e=t.notOneOf||n&&(n.enum||n.oneOf);return this.isNothing(e)?this:(e=Array.isArray(e)?e:[e],this.addConstraint("notOneOf",{values:e}))},i.valErrMessage=function(t){return this.errorMessageHandler.valErrMessage(t)},i.createWhenConditionFor=function(t){return(this.config.createWhenCondition||O)({key:this.key,type:this.type,value:this.value,schema:this.schema,properties:this.properties,config:this.config,when:t})},i.when=function(){var t,n=this.constraints.when;if((t=n)!==Object(t))return this;var e=this.createWhenConditionFor(n).constraint;return e?(this.logInfo("Adding when constraint for "+this.key,e),this.addConstraint("when",{values:e,errName:"when"}),this):(this.warn("Invalid when constraint for: "+n),this)},i.isType=function(){return this.addConstraint("isType",{value:this.constraints.isType,errName:"notOneOf"}),this},i.nullable=function(){var t=this.constraints;return this.addConstraint("nullable",{value:t.nullable||t.isNullable,errName:"notOneOf"}),this},i.message=function(){return config.messages[this.key]||config.messages[this.type]||{}},i.errMessage=function(t){return void 0===t&&(t="default"),this.message[t]||"error"},i.toValidJSONSchema=function(){},i.normalize=function(){},i.deNormalize=function(){},i.errorMsg=function(t){this.throwError(t)},i.error=function(t,n){var e=["["+t+"]",n].join(" ");this.errorMsg(e)},i.throwError=function(t){throw t},a(r,[{key:"mode",get:function(){return this.config.mode||{}}},{key:"disableFlags",get:function(){return[!1,"disabled","no","off"]}},{key:"enableFlags",get:function(){return[!0,"enabled","yes","on"]}},{key:"shouldPreProcessValue",get:function(){return!this.disabledMode("notRequired")}},{key:"value",set:function(t){this._value=this.preProcessedConstraintValue(t)},get:function(){return this._value}},{key:"mixedEnabled",get:function(){return this.mixedConfig.enabled||["oneOf","notOneOf","when","nullable","isType"]}},{key:"typeEnabled",get:function(){return[]}},{key:"$typeExtends",get:function(){if(Array.isArray(this.typeConfig.extends))return e([].concat(this.typeConfig.extends,this.typeEnabled))}},{key:"configuredTypeEnabled",get:function(){return Array.isArray(this.typeConfig.enabled)?this.typeConfig.enabled:this.typeEnabled}},{key:"$typeEnabled",get:function(){return this.$typeExtends||this.configuredTypeEnabled}},{key:"enabled",get:function(){return[].concat(this.mixedEnabled,this.$typeEnabled)}},{key:"constraintsMap",get:function(){return{simple:["required","notRequired","nullable"],value:["default","strict"]}}}]),r}(b),S=["oneOf","enum","required","notRequired","minDate","min","maxDate","max","trim","lowercase","uppercase","email","url","minLength","maxLength","pattern","matches","regex","integer","positive","minimum","maximum"],j={errMessages:function(t){return void 0===t&&(t=S),t.reduce(function(t,n){return t[n]=function(t){var n=t.value;return t.key+": invalid for "+(n.name||n.title)},t},{})}},A=function(t){function n(n){var e;return(e=t.call(this,n)||this).type="array",e.base=e.yup.array(),e.createYupSchemaEntry=e.config.createYupSchemaEntry,e}u(n,t),n.create=function(t){return new n(t)};var e=n.prototype;return e.convert=function(){return t.prototype.convert.call(this),this},e.ensureItems=function(){return this.addConstraint("ensure")},e.compact=function(){return this.addConstraint("compact")},e.itemsOf=function(){var t=this.constraints,n=t.items||t.itemsOf||this.constraints.of;if(!this.isNothing(n))if(Array.isArray(n))this.error("itemsOf","does not (yet) support an Array of schemas");else if(this.isObjectType(n)){if(this.createYupSchemaEntry){try{var e=this.createYupSchemaEntry({key:this.key,value:n,config:this.config});return this.addConstraint("of",{constraintValue:e,propValue:n})}catch(t){this.error("itemsOf: Error",t)}return this}this.warn("missing createYupSchemaEntry in config, needed for recursive validation")}else this.error("itemsOf","must be a schema object, was "+typeof n)},e.maxItems=function(){var t=this.constraints,n=t.maxItems||t.max;if(!this.isNumberType(n))return this;if(!this.isValidSize(n))return this.handleInvalidSize("maxItems",n);var e=n&&this.base.max(n);return this.base=e||this.base,this},e.minItems=function(){var t=this.constraints,n=t.minItems||t.min;if(!this.isNumberType(n))return this;if(!this.isValidSize(n))return this.handleInvalidSize("minItems",n);var e=n&&this.base.min(n);return this.base=e||this.base,this},e.$items=function(){return this},e.$additionalItems=function(){return this},e.$uniqueItems=function(){return this},e.$contains=function(){return this},e.handleInvalidSize=function(t,n){var e="invalid array size constraint for "+t+", was "+n+". Must be a number >= 0";return this.config.warnOnInvalid?(this.warn(e),this):(this.error(e,n),this)},e.isValidSize=function(t){return this.isNumberType(t)&&t>=0},a(n,[{key:"typeEnabled",get:function(){return["maxItems","minItems","ensureItems","compact","itemsOf"]}}]),n}(x),V=function(t){function n(n){return t.call(this,n)||this}u(n,t);var e=n.prototype;return e.isArray=function(t){return this.config.isArray||this.error("ArrayHandler: mising isArray in config",this.config),this.config.isArray(t)},e.handle=function(t){return this.isArray(t)&&A.create(t).createSchemaEntry()},n}(b);function F(t,n){return void 0===n&&(n={}),t&&new V(n).handle(t)}var R=function(t){function n(n){var e;return(e=t.call(this,n)||this).type="boolean",e.base=e.yup.boolean(),e}return u(n,t),n.create=function(t){return new n(t)},n}(x),D=function(){function t(t){this.config=t}var n=t.prototype;return n.isBoolean=function(t){return this.config.isBoolean(t)},n.handle=function(t){return this.isBoolean(t)&&R.create(t).createSchemaEntry()},t}();function I(t,n){return void 0===n&&(n={}),t&&new D(n).handle(t)}var P=function(t){function n(n){return t.call(this,n)||this}return u(n,t),a(n,[{key:"$map",get:function(){return{moreThan:["exclusiveMinimum","moreThan"],lessThan:["exclusiveMaximum","lessThan"],max:["maximum","max"],min:["minimum","min"]}}}]),n}(function(t){function n(n){return t.call(this,n)||this}u(n,t);var e=n.prototype;return e.transform=function(t){return this.typer.toNumber(t)},e.isValidConstraint=function(t){return this.typer.isNumberLike(t)},a(n,[{key:"explainConstraintValidMsg",get:function(){return"Must be a number or convertible to a number"}}]),n}(function(t){function n(n,e){var r;return(r=t.call(this,n.config)||this).map=e||r.$map||{},r.typer=n,r.delegates.map(function(t){var e=n[t];e||r.error("missing delegate: "+t,{typer:n}),r[t]=r.isFunctionType(e)?e.bind(n):e}),r}u(n,t);var e=n.prototype;return e.isStringType=function(t){return"string"==typeof t},e.add=function(){var t=this,n=this.map;Object.keys(n).map(function(e){var r=t.entryNames(n[e]);t.addConstraints(e,r)})},e.entryNames=function(t){return Array.isArray(t)?t:[t]},e.addConstraints=function(t,n){var e=this;return void 0===n&&(n=[]),n.map(function(n){var r=e.validateAndTransform(n);e.addConstraint(n,{method:t,value:r})}),this},e.validateAndTransform=function(t){var n=this.constraints[t];return this.validate(n),this.transform(n)},e.invalidMsg=function(t,n){return"invalid constraint for "+t+", was "+n+"."},e.invalidConstraintMsg=function(t,n){return[this.invalidMsg(t,n),this.explainConstraintValidMsg].join("\n")},e.validate=function(t){return this.isNothing(t)?this:this.isValidConstraint(t)?void 0:this.handleInvalidConstraint(name,t)},e.isValidConstraint=function(t){return!0},e.handleInvalidConstraint=function(t,n){var e=this.invalidConstraintMsg(t,n);return this.config.warnOnInvalid?(this.warn(e),this):(this.error(e,n),this)},a(n,[{key:"delegates",get:function(){return["constraints","addConstraint","constraintsAdded"]}},{key:"explainConstraintValidMsg",get:function(){return""}}]),n}(g))),Y=function(t){function n(n,e){return t.call(this,n,e)||this}return u(n,t),n.prototype.isValid=function(){return this.config.isNumber(this.obj)},n}(function(t){function n(n,e){var r;return(r=t.call(this,e)||this).obj=n,r}u(n,t);var e=n.prototype;return e.isValid=function(){return!1},e.verify=function(){return this.isPresent(this.obj)&&this.isValid(this.obj)},n}(b)),q=function(t,n){return void 0===n&&(n={}),function(t,n){return new Y(t,n)}(t,n).verify()};function H(t,n){return void 0===n&&(n={}),q(t,n)&&function(t){return z.schemaEntryFor(t)}(t)}var z=function(t){function n(n){var e,r;return(e=t.call(this,n)||this).type=e.normalizeNumType(n.type),e.base=e.yup.number(),e.rangeConstraint=(r=d(e),new P(r)),e}u(n,t);var e=n.prototype;return e.normalizeNumType=function(t){return"int"===t?"integer":t},n.create=function(t){return new n(t)},n.schemaEntryFor=function(t){return n.create(t).createSchemaEntry()},e.convert=function(){return t.prototype.convert.call(this),this},e.range=function(){this.rangeConstraint.add()},e.truncate=function(){return this.addConstraint("truncate")},e.round=function(){var t=this.constraints.round;if(this.isNothing(t))return this;var n=this.isStringType(t)?t:"round";return t&&this.base.round(n),this},e.posNeg=function(){this.positive(),this.negative()},e.integer=function(){return this.isInteger&&this.addConstraint("integer"),this},e.positive=function(){return this.addConstraint("positive")},e.negative=function(){return this.addConstraint("negative")},e.normalize=function(){this.constraints.maximum=this.constraints.maximum||this.constraints.max,this.constraints.minimum=this.constraints.minimum||this.constraints.min},a(n,[{key:"typeEnabled",get:function(){return["range","posNeg","integer"]}},{key:"isInteger",get:function(){return this.config.isInteger(this.type)}},{key:"isNegative",get:function(){var t=this.constraints,n=t.exclusiveMaximum;return!!t.negative||void 0!==n&&0===n}},{key:"isPositive",get:function(){var t=this.constraints,n=t.exclusiveMinimum;return!!t.positive||void 0!==n&&0===n}}]),n}(x),B=function(t){function n(n){var e;return(e=t.call(this,n)||this).type="object",e.base=e.yup.object(),e.properties=e.value.properties,e}u(n,t),n.create=function(t){return new n(t)};var e=n.prototype;return e.convert=function(){if(!this.properties)return this;t.prototype.convert.call(this);var n=this.value,e=this.config;if(n){e.buildYup||this.error("convert","Missing buildYup function from config",e);var r=this.config.buildYup(n,e);this.base=r}return this},e.camelCase=function(){return this.addConstraint("camelCase")},e.constantCase=function(){return this.addConstraint("constantCase")},e.noUnknown=function(){var t=this.value,n=t.noUnknown||t.propertyNames,e=n&&this.base.noUnknown(n,this.valErrMessage("propertyNames")||this.valErrMessage("noUnknown"));return this.base=e||this.base,this},a(n,[{key:"typeEnabled",get:function(){return["noUnknown","camelCase","constantCase"]}}]),n}(x),_=function(t){return t&&"object"===t.type},L=function(){function t(t){void 0===t&&(t={}),(t=t||{}).isObject=t.isObject||_,this.config=t,this.schema=t.schema}var n=t.prototype;return n.isObject=function(t){return this.config.isObject(t.value)},n.handle=function(t){return this.isObject(t)&&B.create(o({},t,{config:this.config})).createSchemaEntry()},t}();function $(t,n){return void 0===n&&(n={}),t&&new L(n).handle(t)}var K=function(t){function n(n){var e;return(e=t.call(this,n)||this).type="string",e.base=e.yup.string(),e}u(n,t),n.create=function(t){return new n(t)};var e=n.prototype;return e.convert=function(){return t.prototype.convert.call(this),this},e.trim=function(){return this.addConstraint("trim")},e.lowercase=function(){return this.addConstraint("lowercase")},e.uppercase=function(){return this.addConstraint("uppercase")},e.genericFormat=function(){1!=!this.config.format&&this.yup.prototype[this.format]&&this.addConstraint(this.format)},e.email=function(){if(!this.isEmail)return this;var t=this.constraintNameFor("email","format");return this.addConstraint("email",{constraintValue:!0,constraintName:t,method:"email",errName:"email"}),this},e.constraintNameFor=function(){var t=this;return[].slice.call(arguments).find(function(n){return t.constraints[n]})},e.url=function(){if(!this.isUrl)return this;var t=this.constraintNameFor("url","format");return this.addConstraint("url",{constraintValue:!0,constraintName:t,method:"url",errName:"url"}),this},e.minLength=function(){var t=this.constraints.minLength,n=this.valErrMessage("minLength")||this.valErrMessage("min"),e=t&&this.base.min(t,n);return this.base=e||this.base,this},e.maxLength=function(){var t=this.constraints.maxLength,n=this.valErrMessage("maxLength")||this.valErrMessage("max"),e=t&&this.base.max(t,n);return this.base=e||this.base,this},e.pattern=function(){var t=this.constraints,n=t.pattern;if(!n)return this;var e=new RegExp(n,t.flags),r=this.valErrMessage("pattern")||this.valErrMessage("matches")||this.valErrMessage("regex"),i=e&&this.base.matches(e,r);return this.base=i||this.base,this},e.normalize=function(){this.constraints.pattern=this.constraints.pattern||this.constraints.matches||this.constraints.regex,this.constraints.maxLength=this.constraints.maxLength||this.constraints.max,this.constraints.minLength=this.constraints.minLength||this.constraints.min},a(n,[{key:"typeEnabled",get:function(){return["normalize","minLength","maxLength","pattern","lowercase","uppercase","email","url","genericFormat"]}},{key:"isEmail",get:function(){return this.constraints.email||"email"===this.format}},{key:"isUrl",get:function(){return this.constraints.url||"url"===this.format}}]),n}(x),U=function(){function t(t){this.config=t}var n=t.prototype;return n.isString=function(t){return this.config.isString(t)},n.handle=function(t){return this.isString(t)&&K.create(o({config:this.config},t)).createSchemaEntry()},t}();function W(t,n){return void 0===n&&(n={}),t&&new U(n).handle(t)}var J=function(t){function n(n){var e;return(e=t.call(this,n)||this).type="date",e.base=e.yup.date(),e}u(n,t),n.create=function(t){return new n(t)};var e=n.prototype;return e.convert=function(){return t.prototype.convert.call(this),this},e.toDate=function(t){return new Date(t)},e.isValidDateType=function(t){return this.isStringType(t)||this.isDateType(t)},e.isValidDate=function(t){return!!this.isValidDateType(t)&&(!this.isStringType(t)||Boolean(Date.parse(t)))},e.transformToDate=function(t){return this.isNumberType(t)?new Date(t):t},e.minDate=function(){var t=this.constraints.minDate||this.constraints.min;if(this.isNothing(t))return this;var n=this.transformToDate(t);if(!this.isValidDateType(n))return this.handleInvalidDate("minDate",n);var e=n&&this.base.min(this.toDate(n),this.valErrMessage("minDate")||this.valErrMessage("min"));return this.base=e||this.base,this},e.maxDate=function(){var t=this.constraints.maxDate||this.constraints.max;if(this.isNothing(t))return this;var n=this.transformToDate(t);if(!this.isValidDateType(n))return this.handleInvalidDate("maxDate",n);var e=n&&this.base.max(this.toDate(n),this.valErrMessage("maxDate")||this.valErrMessage("max"));return this.base=e||this.base,this},e.handleInvalidDate=function(t,n){var e="invalid constraint for "+t+", was "+n+". Must be a number, string (valid date format) or a Date instance";return this.config.warnOnInvalid?(this.warn(e),this):(this.error(e,n),this)},a(n,[{key:"typeEnabled",get:function(){return["minDate","maxDate"]}}]),n}(x),G=function(){function t(t){this.config=t}var n=t.prototype;return n.isDate=function(t){return this.config.isDate(t)},n.handle=function(t){return this.isDate(t)&&J.create(t).createSchemaEntry()},t}();function Q(t,n){return void 0===n&&(n={}),t&&new G(n).handle(t)}var X={__proto__:null,errValKeys:S,defaults:j,YupArray:A,toYupArray:F,YupBoolean:R,toYupBoolean:I,YupNumber:z,toYupNumberSchemaEntry:H,toYupNumber:function(t,n){return void 0===n&&(n={}),q(t,n)&&function(t){return z.create(t)}(t)},YupObject:B,toYupObject:$,YupString:K,toYupString:W,YupDate:J,toYupDate:Q,YupMixed:x,ConvertYupSchemaError:T,Base:b},Z=function(t){function n(){return t.apply(this,arguments)||this}return u(n,t),n}(p(Error)),tt=function(t){function n(n,e){var r;r=t.call(this,e)||this;var i=n.value,s=n.type,a=n.kind,o=n.name,u=n.key,c=n.schema,h=n.types;return r.opts=n,r.kind=a,r.value=i,r.schema=c,r.key=u,r.value=i||{},r.name=o,r.type=s,r.types=h,r}u(n,t);var e=n.prototype;return e.error=function(t,n){var e,r,i=this.opts;throw n?(e=console).error.apply(e,[t,n].concat(i)):(r=console).error.apply(r,[t].concat(i)),new Z(t)},e.resolve=function(){throw"Must be implemented by subclass"},a(n,[{key:"obj",get:function(){return{schema:this.schema,key:this.key,value:this.value,type:this.type,kind:this.kind,config:this.config}}}]),n}(b),nt=function(t){function n(n,e){return t.call(this,n,e)||this}return u(n,t),n.prototype.resolve=function(){if(Array.isArray(this.value)){var t=this.config.toMultiType;return t?t(this):void 0}},n}(tt),et=function(t){function n(n,e){return t.call(this,n,e)||this}return u(n,t),n.prototype.resolve=function(){if(!Array.isArray(this.value)){var t=this.config.toSingleType;if(t)return t(this);for(var n,e=this.obj,r=this.config,i=0,s=Object.keys(this.types);i<s.length;i++){var a=this.types[s[i]];if(a&&(n=a(e,r)),n)break}return n}},n}(tt),rt=function(t,n){return new it(t,n)},it=function(t){function n(n,e){var r;return(r=t.call(this,n,e)||this).initResolvers(),r}u(n,t);var e=n.prototype;return e.initResolvers=function(){var t=this.opts,n=this.config,e=n.createMultiTypeResolver||this.createMultiTypeResolver.bind(this);this.multiTypeResolver=e(t,n);var r=n.createSingleTypeResolver||this.createSingleTypeResolver.bind(this);this.singleTypeResolver=r(t,n)},e.createMultiTypeResolver=function(){return new nt(this.opts,this.config)},e.createSingleTypeResolver=function(){return new et(this.opts,this.config)},e.resolve=function(){return this.toMultiType()||this.toSingleType()||this.toDefaultEntry()},e.toMultiType=function(){return(this.config.toMultiType||this.singleTypeResolver.resolve.bind(this.singleTypeResolver))(this)},e.toSingleType=function(){return(this.config.toSingleType||this.singleTypeResolver.resolve.bind(this.singleTypeResolver))(this)},e.toDefaultEntry=function(){return this.defaultType()},e.defaultType=function(){this.error("toEntry: unknown type",this.type)},n}(tt),st=function(t){function n(){return t.apply(this,arguments)||this}return u(n,t),n}(p(Error)),at=function(t){function n(n){var e;e=t.call(this,n.config)||this;var r=n.schema,i=n.name,s=n.key,a=n.value,o=n.config;e.opts=n,e.schema=r,e.key=s,e.value=a||{},e.config=o||{},e.name=i;var u=Array.isArray(a)?"array":a.type;return e.kind="array"===u?"multi":"single",e.type=u,e.setTypeHandlers(),e.setPropertyHandler(),e}u(n,t);var e=n.prototype;return e.setPropertyHandler=function(){var t=this.config;this.propertyValueHandler=(t.createPropertyValueHandler||this.createPropertyValueHandler)({type:this.type,kind:this.kind,types:this.types,value:this.value,name:this.name,key:this.key,schema:this.schema},t)},e.createPropertyValueHandler=function(t,n){return rt(t,n)},e.setTypeHandlers=function(){this.types=o({},this.defaultTypeHandlerMap,this.config.typeHandlers||{})},e.isValidSchema=function(){return this.isStringType(this.type)},e.error=function(t,n){var e,r,i=this.opts;throw n?(e=console).error.apply(e,[t,n].concat(i)):(r=console).error.apply(r,[t].concat(i)),new st(t)},e.toEntry=function(){if(!this.isValidSchema()){var t=JSON.stringify(this.schema);this.error("Not a valid schema: type "+this.type+" must be a string, was "+typeof this.type+" "+t)}return this.propertyValueHandler.resolve(this.opts,this.config)},a(n,[{key:"defaultTypeHandlerMap",get:function(){return{string:W,number:H,boolean:I,array:F,object:$,date:Q}}}]),n}(b);function ot(t){return void 0===t&&(t={}),new at(t).toEntry()}var ut={alphanumeric:{optsKey:"locale"},alpha:{optsKey:"locale"},ascii:{},byte:{},creditCard:{},currency:{opts:"currencyOpts"},dataUri:{},dateTime:{},date:{},domainName:{opts:"domainOpts"},hash:{opts:"hashAlgo"},hexColor:{},ipv4:{},ipv6:{},isbn:{},magnetUri:{},mimeType:{},mobilePhone:{},mongoId:{},postalCode:{},uuid:{}},ct={createValidatorName:function(t,n){return"is"+(t=(t=i(t||n)).replace(/Uri$/,"URI")).replace(/Id$/,"ID")},createTestName:function(t,n){return r(t||n)}},ht={isMagnetURI:function(t,n){return/magnet:\?xt=urn:[a-z0-9]+:[a-z0-9]{32}/i.test(t)}};function ft(t,n){return void 0===n&&(n={}),new pt(t,n).yupSchema}function lt(t){return t===Object(t)}var pt=function(t){function e(n,e){var r;void 0===e&&(e={}),r=t.call(this,e)||this,e.buildYup=ft,e.createYupSchemaEntry=e.createYupSchemaEntry||ot,r.config=Object.assign(r.config,e),r.schema=n;var i=r.getType(n),s=r.getProps(n);if(r.type=i,r.properties=s,r.additionalProps=r.getAdditionalProperties(n),r.required=r.getRequired(n),!function(t){return t&&"object"===t}(i))return r.error('invalid schema: must be type: "object", was type: '+i),d(r);if(!lt(s)){var a=JSON.stringify(u);return r.error("invalid schema: must have a properties object: "+a),d(r)}var o=r.getName(n),u=r.normalizeRequired(n),c=r.propsToShape({properties:u,name:o,config:e});return r.shapeConfig=c,r.validSchema=!0,r}u(e,t);var r=e.prototype;return r.getAdditionalProperties=function(t){return t.additionalProperties},r.getRequired=function(t){var n=this.config.getRequired;return n?n(t):t.required||[]},r.getProps=function(t){return this.config.getProps(t)},r.getType=function(t){return this.config.getType(t)},r.getName=function(t){return this.config.getName(t)},r.normalizeRequired=function(){var t=this,n=o({},this.properties),e=[].concat(this.required)||[];return Object.keys(n).reduce(function(r,i){var s=n[i],a=e.indexOf(i)>=0;return lt(s)?s.required=t.isRequired(s)||a:t.warn("Bad value: "+s+" must be an object"),r[i]=s,r},{})},r.isRequired=function(t){return this.config.isRequired(t)},r.propsToShape=function(t){void 0===t&&(t={});var n=this.objPropsToShape(t);return this.objPropsShape=n,this.addPropsShape=this.additionalPropsToShape(t,n),n},r.additionalPropsToShape=function(t,n){return n},r.objPropsToShape=function(t){var n=this,e=t.name,r=o({},this.properties);return Object.keys(r).reduce(function(t,i){var s=n.propToYupSchemaEntry({name:e,key:i,value:r[i]});return n.logInfo("propsToShape",{key:i,yupSchemaEntry:s}),t[i]=s,t},{})},r.propToYupSchemaEntry=function(t){var n=t.value;return this.createYupSchemaEntry({schema:this.schema,name:t.name,key:t.key,value:void 0===n?{}:n,config:this.config})},r.createYupSchemaEntry=function(t){var n=t.config;return n.createYupSchemaEntry({schema:t.schema,name:t.name,key:t.key,value:t.value,config:n})},a(e,[{key:"yupSchema",get:function(){return n.object().shape(this.shapeConfig)}}]),e}(b);exports.ConstraintBuilder=N,exports.ErrorMessageHandler=M,exports.PropertyValueResolver=it,exports.YupBuilder=pt,exports.YupSchemaEntry=at,exports.YupSchemaEntryError=st,exports.buildYup=ft,exports.createPropertyValueResolver=rt,exports.createYupSchemaEntry=ot,exports.extendYupApi=function(t){var e,r=this,i=void 0===t?{}:t,s=i.constraints,a=i.override,u=void 0!==a&&a,c=i.validator,h=i.createValidatorName,f=i.createTestName;if(!c)throw"extendYupApi: missing validator option";Array.isArray(s)&&(void 0===e&&(e={}),s=s.reduce(function(t,n){if("string"!=typeof n&&!(n instanceof Object)){if(!1!==e.throws)throw"toConstraintsMap: invalid entry "+n;return t}if("string"==typeof n)t[name]={};else{if(!n.name){if(!1!==e.throws)throw"toConstraintsMap: invalid entry "+n+" missing name";return t}t[n.name]=n}return t},{})),s=u?s||ut:o({},ut,s||{}),h=h||ct.createValidatorName,f=f||ct.createTestName,Object.keys(s).map(function(t){var e=s[t],i=e.testName,a=e.optsKey,o=e.logging,u=h(e.validatorName,t);i=f(i,t),n.addMethod(n.string,t,function(e){void 0===e&&(e={});var s=e.message,h=e[a];return n.string().test(i,s,function(n){var e=r.path,a=r.createError,f=c[u];if("function"!=typeof(f=f||ht[u]))throw Error("No method named ${validatorName} on validator");var l=f(n,h);return!0===o&&console.log("Yup validator bridge",{key:t,fullValidatorName:u,testName:i,value:n,valid:l}),l||a({path:e,message:s})})})})},exports.types=X;
//# sourceMappingURL=index.js.map
